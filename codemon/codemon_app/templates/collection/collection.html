{% extends 'base.html' %}
{% load static %}

{% block title %}My Collection - CodeMon{% endblock %}

{% block content %}
<div class="page-container">
    <header class="page-header">
        <h1 class="page-title">My Codemon Collection</h1>
        <p class="page-subtitle">Codemon captured: {{ collection.count }}</p>
    </header>
    <div class="collection-actions">
        <a href="{% url 'codemon-create' %}" class="btn btn-primary">
            ‚ûï Create New Codemon
        </a>
    </div>

    {% if collection %}
    <div class="collection-grid">
        {% for item in collection %}
        <article class="collection-card">
            <div class="collection-card__image">
                {% if item.codemon.image_url %}
                <img src="{% static item.codemon.image_url %}" alt="{{ item.codemon.name }}" class="codemon-img">
                {% else %}
                <div class="placeholder-img">üêâ</div>
                {% endif %}
            </div>

            <header class="collection-card__header">
                <h2 class="collection-card__name">{{ item.codemon.name }}</h2>
                <div class="collection-card__badges">
                    <span class="track-badge" style="background-color: {{ item.codemon.tech_track.color }}">
                        {{ item.codemon.tech_track.name }}
                    </span>
                    <div class="codemon-card__meta">
                        {% if item.codemon.created_by %}
                        <span class="creator-badge">Created by {{ item.codemon.created_by.username }}</span>
                        {% else %}
                        <span class="creator-badge">Official Codemon</span>
                        {% endif %}
                    </div>
                </div>
            </header>

            <div class="collection-card__content">
                <div class="collection-card__skills">
                    <span class="label">Skills:</span>
                    <div class="skills-list">
                        {% for skill in item.codemon.skills.all %}
                        <span class="skill-tag">{{ skill.name }}</span>
                        {% endfor %}
                    </div>
                </div>
                <div class="collection-card__meta">
                    <p class="collection-card__captured">
                        <span class="label">Captured:</span> {{ item.captured_date|date:"M d, Y" }}
                    </p>
                    <p class="collection-card__score">
                        <span class="label">Battle Score:</span> {{ item.capture_score|floatformat:0 }}%
                    </p>
                </div>
            </div>
            {% if item.codemon.created_by == user %}
            <div class="collection-card__actions">
                <a href="{% url 'codemon-update' item.codemon.id %}" class="btn btn-small btn-edit">Edit</a>
                <a href="{% url 'codemon-delete' item.codemon.id %}" class="btn btn-small btn-danger">Delete</a>
            </div>
            {% endif %}
        </article>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
        <div class="empty-state__icon">üìö</div>
        <h2 class="empty-state__title">No Codemon Captured Yet!</h2>
        <div class="empty-state__content">
            <p>Battle Codemon and score 80% or higher to add them to your collection.</p>
        </div>
        <div class="empty-state__actions">
            <a href="{% url 'battle-encounter' %}" class="btn btn-battle">Start Battling</a>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}